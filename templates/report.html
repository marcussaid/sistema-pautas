{% extends 'base.html' %}
{% block content %}
<!-- [Conteúdo anterior mantido igual até a função viewDetails] -->

function viewDetails(id) {
    fetch(`/registro/${id}`)
        .then(response => response.json())
        .then(data => {
            // Constrói a seção principal de informações
            const mainInfo = [
                '<div class="grid grid-cols-2 gap-4 mb-6">',
                '<div>',
                '<p class="text-sm text-gray-600">Data</p>',
                '<p class="font-medium">' + (data.data || 'N/A') + '</p>',
                '</div>',
                '<div>',
                '<p class="text-sm text-gray-600">Status</p>',
                '<p class="font-medium">' + (data.status || 'N/A') + '</p>',
                '</div>',
                '<div class="col-span-2">',
                '<p class="text-sm text-gray-600">Local</p>',
                '<p class="font-medium">' + (data.local || 'N/A') + '</p>',
                '</div>',
                '<div class="col-span-2">',
                '<p class="text-sm text-gray-600">Demanda</p>',
                '<p class="font-medium">' + (data.demanda || 'N/A') + '</p>',
                '</div>',
                '<div class="col-span-2">',
                '<p class="text-sm text-gray-600">Assunto</p>',
                '<p class="font-medium">' + (data.assunto || 'N/A') + '</p>',
                '</div>',
                '<div class="col-span-2">',
                '<p class="text-sm text-gray-600">Direcionamentos</p>',
                '<p class="font-medium">' + (data.direcionamentos || 'N/A') + '</p>',
                '</div>',
                '<div>',
                '<p class="text-sm text-gray-600">Último Editor</p>',
                '<p class="font-medium">' + (data.ultimo_editor || 'N/A') + '</p>',
                '</div>',
                '<div>',
                '<p class="text-sm text-gray-600">Última Edição</p>',
                '<p class="font-medium">' + (data.data_ultima_edicao || 'N/A') + '</p>',
                '</div>',
                '</div>'
            ].join('');

            // Constrói a seção de anexos
            let anexosHtml = '';
            if (data.anexos && data.anexos.length > 0) {
                const anexosList = data.anexos.map(anexo => `
                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
                        <div class="flex items-center gap-2">
                            <i class="fas fa-file text-gray-600"></i>
                            <span class="text-sm">${anexo.nome_original}</span>
                        </div>
                        <a href="/download_anexo/${data.id}/${anexo.id}" 
                           class="text-blue-600 hover:text-blue-800" 
                           title="Download">
                            <i class="fas fa-download"></i>
                        </a>
                    </div>
                `).join('');

                anexosHtml = `
                    <div class="border-t pt-4 mt-4">
                        <h3 class="text-lg font-bold mb-3">Anexos</h3>
                        <div class="space-y-2">
                            ${anexosList}
                        </div>
                    </div>
                `;
            }

            // Combina as seções
            const content = mainInfo + anexosHtml;
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('detailsModal').classList.remove('hidden');
        })
        .catch(error => {
            console.error('Erro:', error);
            alert('Erro ao carregar os detalhes do registro');
        });
}

<!-- [Resto do conteúdo mantido igual] -->
{% endblock %}
